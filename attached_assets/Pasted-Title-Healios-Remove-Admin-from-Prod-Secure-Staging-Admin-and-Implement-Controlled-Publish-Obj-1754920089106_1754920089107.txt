Title: Healios – Remove Admin from Prod, Secure Staging Admin, and Implement Controlled Publish

Objectives (must all be true to sign off):
- Admin UI is 100% absent from production artifacts and runtime.
- Staging has a secure admin surface for product updates.
- Editors can update products and publish to production via a controlled, auditable pipeline.
- No cross-environment write paths from dev/staging into prod DBs.
- All changes are reversible with one-click rollback.

Non-Goals:
- No anonymous/unauthenticated admin anywhere.
- No shared prod/staging databases. No “temporary” holes.

Deliverables:
1) Build-Time Kill Switch
   - Implement `ADMIN_ENABLED=false` in production build. Tree-shake/remove routes, components, API handlers.
   - Verify production bundle contains no admin code (CI step: grep/size check).
   - Acceptance: hitting any `/admin` or admin API on prod returns 404.

2) Staging Admin Hardening
   - Route served only in staging with `ADMIN_ENABLED=true`.
   - Access controls:
     - Primary: SSO or basic auth.
     - Secondary: IP allowlist/VPN (Cloudflare Access or equivalent).
   - Rate limiting + WAF on admin routes.
   - Acceptance: unauthorised request returns 401; only allowlisted IPs + valid session pass.

3) Content Store and Publish Flow
   Choose ONE:
   A) Headless CMS/DB used by both envs with controlled publish:
      - Editors change content on staging.
      - “Publish to Prod” triggers a CI/CD job that:
        - Pulls approved content snapshot.
        - Builds static artifacts or migrates content via a one-way publish job.
        - Deploys to prod environment.
      - No direct staging-to-prod DB writes.
   B) Git-based content:
      - Admin or local editor writes to content repo (Markdown/JSON).
      - PR -> mandatory review -> CI static build -> deploy.
   - Acceptance: publisher role can publish without SSH/console access; audit log recorded.

4) Secrets & Environment Hygiene
   - Separate `.env` for dev/staging/prod in secret manager.
   - Remove any fallback defaults enabling admin; fail closed by default.
   - Acceptance: toggling `ADMIN_ENABLED` is the only way to include admin.

5) Observability & Audit
   - Structured logs for all admin actions (who, what, when, before/after diff).
   - Alert on admin 4xx/5xx spikes.
   - Store publish artifacts and content snapshots for 30+ days.

6) Test Plan (must pass)
   - Unit: admin routes excluded when `ADMIN_ENABLED=false`.
   - E2E: staging admin happy path (login -> edit product -> preview -> publish -> prod reflects).
   - Security: attempt access to staging admin from non-allowlisted IP = blocked.
   - Regression: prod site works with no admin code; 404 on admin paths.

7) Rollback Plan
   - One-click rollback to previous content snapshot and previous deploy artifact.
   - Document exact steps; test once.

8) Documentation
   - Short runbook: How to edit, preview, publish, rollback.
   - Architecture diagram: flows between staging admin, content store, CI, prod.

Report Back Checklist:
- [ ] Prod build artifact diff confirming admin removed
- [ ] Staging auth and IP allowlist proof
- [ ] CI pipeline link + publish logs
- [ ] E2E test evidence: screenshots or recordings
- [ ] Rollback test evidence
- [ ] Runbook link
