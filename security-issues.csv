ID,Type,Description,Severity,File,Line,Snippet,Fixed
dtIgc18xr2e0UQ,unvalidatedInput,Request data destructured without validation,critical,server/lib/auth.ts,202,"const { customerEmail } = req.body;",false
NFb7f8W6yA2TwQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/carts.ts,80,"const { cartId } = req.params;",false
1YhEZ4L7yz9trg,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/logs.ts,72,"const { adminId } = req.params;",false
gOp0fwXhlMS12A,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/logs.ts,84,"const { targetType, targetId } = req.params;",false
ZQlo9DJVXGCRqw,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,593,"const { status, channel, limit = 100 } = req.query;",false
UQN9e0X4IUGUoQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,826,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
2edcILYEn8OlDA,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,873,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
-J9Q5FmynnhPxw,rawSQL,Raw SQL query without parameterization,critical,server/routes/admin.ts,698,"const orderCountResult = await db.execute(sql`SELECT COUNT(*) as count FROM orders`);",false
WoUNzY7qAao3FQ,rawSQL,Raw SQL query without parameterization,critical,server/routes/admin.ts,702,"sql`SELECT SUM(CAST(total_amount AS DECIMAL)) as total FROM orders WHERE payment_status = 'completed'`",false
e7_XPIzlvPJYPQ,rawSQL,Raw SQL query without parameterization,critical,server/routes/admin.ts,727,"sql`SELECT COUNT(DISTINCT customer_email) as count FROM orders WHERE created_at >= NOW() - INTERVAL '30 days'`",false
Jq83I2a31RXfbg,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,260,"router.post('/products', requireAuth, auditAction('create_product', 'product'), async (req, res) => {",false
711OzNcKpiuKlA,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,324,"router.put('/products/:id', requireAuth, auditAction('update_product', 'product'), async (req, res) => {",false
RnJWUDCiwSu7NA,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,402,"router.delete('/products/:id', requireAuth, auditAction('delete_product', 'product'), async (req, res) => {",false
G2MLljafHOWnKQ,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,824,"router.post('/products/:id/variants', requireAuth, async (req, res) => {",false
K3XwgsfAzBoeXQ,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,915,"router.delete('/product-variants/:id', requireAuth, async (req, res) => {",false
2EE_BMphgUFbJA,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,142,"const { id: bundleId } = req.params;",false
ecq8t5AUW0U-vg,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,143,"const { items } = req.body; // Array of { variantId, quantity }",false
IWNyPAMLpVoeMw,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,233,"const { id } = req.params;",false
TqqjojZLqyrv9A,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,273,"const { bundleId, itemId } = req.params;",false
1XPDitpXi4K-0A,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,302,"const { id } = req.params;",false
gsyzE5T5oK65Aw,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,96,"router.post(""/"", requireAuth, async (req, res) => {",false
Yule1heGCPlm4w,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,231,"router.put(""/:id"", requireAuth, async (req, res) => {",false
2FKUdRPQs90O3w,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,300,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
4Khkm6aay9GKcg,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,21,"router.post(""/"", requireAuth, async (req, res) => {",false
JI7BlWbP8e2A8g,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,169,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
Y5aeEfolnW7IuQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminImages.ts,27,"const { uploadURL } = req.body;",false
9V2S0wBTqCcZCA,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,35,"router.post(""/chat"", async (req, res) => {",false
Zccbmtt2ycAVlA,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,89,"router.post(""/escalate"", async (req, res) => {",false
57IiidU-CQ_rlg,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,179,"router.post(""/feedback"", async (req, res) => {",false
f5zKvHdcYSEybw,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,19,"router.get(""/issues"", async (req, res) => {",false
w8Hjr1wFNFS7Hw,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,32,"router.get(""/status"", async (req, res) => {",false
zA9oecK-VYwNEA,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,51,"router.post(""/issues/:id/fix-prompt"", async (req, res) => {",false
orYT_0JgDqZ8iw,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,91,"router.post(""/scan"", async (req, res) => {",false
fAoZy4FLZIEsEg,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,53,"const { id } = req.params;",false
hFLRKOjsx7ghCw,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,184,"const { id } = req.params;",false
WV7Cf7XtX0sH6Q,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,185,"const { status } = req.body;",false
B-C7sPnpASBA2g,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,25,"router.get('/me', async (req, res) => {",false
cWSB-GNEaMeY_Q,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,74,"router.post(""/register"", (req, res) => {",false
1F9Hu8nRcKzcCQ,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,79,"router.get('/login', (req, res) => {",false
P4DQ1vkr6xhoMg,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,90,"router.post('/logout', async (req, res) => {",false
kZrK3oGc0NXmgA,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,108,"router.post('/mock-login', loginLimiter, async (req, res) => {",false
ocy4pFmQjhATxQ,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,181,"router.get('/callback', async (req, res) => {",false
dPL_2CvLfunkcQ,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,201,"router.post('/demo-admin-login', loginLimiter, async (req, res) => {",false
5Rw1Msvyc0tM0Q,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,8,"router.get(""/"", async (req, res) => {",false
eZ-QjiD3n7edqA,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,19,"router.get(""/:id"", async (req, res) => {",false
-I-5z2SYONzJiw,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,82,"router.post(""/validate"", async (req, res) => {",false
nfXKVyGTYX2Hug,unauthRoute,Route missing authentication middleware,high,server/routes/cart.ts,9,"router.post(""/sync"", requireSessionOrAuth, rateLimit(20, 60000), async (req, res) => {",false
MbYEGZfdhdyiUw,unvalidatedInput,Request data destructured without validation,critical,server/routes/email-test.ts,10,"const { type, email, testData } = req.body;",false
1K0QdW37gY0neA,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,14,"router.get(""/orders"", async (req, res) => {",false
yhqnPWVfzMpI4g,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,38,"router.get(""/orders/:id"", async (req, res) => {",false
K10MboplJXQgBw,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,73,"router.post(""/orders/:id/reorder"", async (req, res) => {",false
xcKzz6UT2dyqOg,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,262,"router.get(""/addresses"", async (req, res) => {",false
PIYz0CvIb98fSw,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
xbHC2W2UB4g2cQ,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,300,"router.put(""/addresses/:id"", async (req, res) => {",false
kx8YKvZ3o0csOw,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
tAEK1hMYJPzmJQ,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,382,"router.get(""/"", async (req, res) => {",false
pyLB9lYsvkGX4g,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
3yW6vP79v1ialg,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
1CNsCWP8qrD98w,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,8,"router.get(""/my-referral"", async (req, res) => {",false
1RlD5w8ponw68Q,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,26,"router.get(""/stats"", async (req, res) => {",false
uZJIR_WGznZOzg,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,41,"router.post(""/validate"", async (req, res) => {",false
ovKtZWszkIA_qA,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,70,"router.post(""/claim"", async (req, res) => {",false
oeAyMsZ0R2sQ7Q,unauthRoute,Route missing authentication middleware,high,server/routes/stripe.ts,9,"router.post(""/webhook"", express.raw({ type: ""application/json"" }), async (req, res) => {",false
PfuMwCXU-_n0WA,unvalidatedInput,Request data destructured without validation,critical,server/routes/subscriptions.ts,108,"const { id } = req.params;",false
Ao-U3NnzcLme8g,unvalidatedInput,Request data destructured without validation,critical,server/routes/subscriptions.ts,146,"const { id } = req.params;",false
qvX35D4pUadXXA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,220,"const { id } = req.params;",false
HUKPU72l4DDT6Q,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,231,"const { id } = req.params;",false
e6sdOoBgW1FLUA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,245,"const { id } = req.params;",false
bSxCS7xyZK1cCw,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,311,"const { orderData, lineItems, successUrl, cancelUrl, sessionToken, discountCode } = req.body;",false
MEcmbwOC6gGHLA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,446,"const { orderData, returnUrl } = req.body;",false
ovhrUeg3unVG9A,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,485,"const { code, subtotal, cartTotal } = req.body;",false
eS3OA2PTH3SjpQ,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,619,"const { items } = req.query;",false
MxJruE1m5MkRiA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,699,"const { status } = req.body;",false
kP-C1eEDiP2Qaw,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,713,"const { quantity } = req.body;",false
U3SR0pp7T34hig,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,742,"const { productId, productName, currentStock } = req.body;",false
xl-EM1wTZniOEw,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,789,"const { firstName, email, product, restockDate } = req.body;",false