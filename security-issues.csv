ID,Type,Description,Severity,File,Line,Snippet,Fixed
05fW7YQsttQcqg,unvalidatedInput,Request data destructured without validation,critical,server/lib/auth.ts,223,"const { customerEmail } = req.body;",false
XesgTBCTJALBtw,unauthRoute,Route missing authentication middleware,high,server/routes/admin/carts.ts,79,"router.post(""/:cartId/recover"", [",false
Frle5eusF601tg,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/carts.ts,94,"const { cartId } = req.params;",false
l01qQW-FNo0qNA,unauthRoute,Route missing authentication middleware,high,server/routes/admin/logs.ts,71,"router.get(""/admin/:adminId"", [",false
uAiEEmu2IU6lQA,unauthRoute,Route missing authentication middleware,high,server/routes/admin/logs.ts,95,"router.get(""/target/:targetType/:targetId"", [",false
flGAiGSVsNqvMg,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/logs.ts,85,"const { adminId } = req.params;",false
X9F9W_xNFQC2nA,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/logs.ts,110,"const { targetType, targetId } = req.params;",false
EUGBLUBuUevnig,unauthRoute,Route missing authentication middleware,high,server/routes/admin.ts,592,"router.get(""/reorder-logs"", [",false
ITOALgUTf4_UJw,unauthRoute,Route missing authentication middleware,high,server/routes/admin.ts,847,"router.post('/products/:id/variants', [",false
m4QAQxnHBbpM6w,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,608,"const { status, channel, limit = 100 } = req.query;",false
oJ2YhSBw9Ds4Bg,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,870,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
NYhgKpKafg43ow,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,917,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
ZznKKcp5e1hzSw,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,261,"router.post('/products', requireAuth, auditAction('create_product', 'product'), async (req, res) => {",false
i4wneWVloTgxXw,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,325,"router.put('/products/:id', requireAuth, auditAction('update_product', 'product'), async (req, res) => {",false
t92OPH3YD6rJpA,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,403,"router.delete('/products/:id', requireAuth, auditAction('delete_product', 'product'), async (req, res) => {",false
vZymfmQPU3GvrA,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,847,"router.post('/products/:id/variants', [",false
jeTfC9yv9qNJ0Q,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,959,"router.delete('/product-variants/:id', requireAuth, async (req, res) => {",false
AVRONpKENWL0Bw,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,142,"const { id: bundleId } = req.params;",false
VwuwGvKilY-ZXA,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,143,"const { items } = req.body; // Array of { variantId, quantity }",false
Ng0BNRQ2Bhy8fg,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,233,"const { id } = req.params;",false
CgzwwpfYKJZ_Mg,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,273,"const { bundleId, itemId } = req.params;",false
xCPglGAeTsgOXA,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,302,"const { id } = req.params;",false
sJQtSoFwmRDDtg,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,96,"router.post(""/"", requireAuth, async (req, res) => {",false
xanrnTGfvvAzag,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,231,"router.put(""/:id"", requireAuth, async (req, res) => {",false
4vhqeHWgNsOffw,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,300,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
cLoRHP63A90Sng,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,21,"router.post(""/"", requireAuth, async (req, res) => {",false
5Vaz4knd5tmEMQ,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,169,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
MavP82xNB61UXA,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminImages.ts,27,"const { uploadURL } = req.body;",false
KnT7t65g0ysOHA,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,35,"router.post(""/chat"", async (req, res) => {",false
9AkfI1XDQS0psg,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,89,"router.post(""/escalate"", async (req, res) => {",false
UlzDnZvEZbtrcQ,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,179,"router.post(""/feedback"", async (req, res) => {",false
B5B7amP1qmpUsg,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,19,"router.get(""/issues"", async (req, res) => {",false
b-VwUmXOGjk5nQ,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,32,"router.get(""/status"", async (req, res) => {",false
nUAd68vp6BFaxg,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,51,"router.post(""/issues/:id/fix-prompt"", async (req, res) => {",false
HzlHTnnW7XUgUQ,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,91,"router.post(""/scan"", async (req, res) => {",false
Kn90bsL2wXcQ1w,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,53,"const { id } = req.params;",false
sXfnlex1BA-vLQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,184,"const { id } = req.params;",false
Fk4POdjFhY01Ew,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,185,"const { status } = req.body;",false
8LjJs_W4YK-I1Q,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,25,"router.get('/me', async (req, res) => {",false
lxvejx57evI8cw,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,74,"router.post(""/register"", (req, res) => {",false
GAKPrlxyGhdEHQ,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,79,"router.get('/login', (req, res) => {",false
ry6A0j2CfRx66A,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,90,"router.post('/logout', async (req, res) => {",false
QU5TA0PfUCvloA,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,108,"router.post('/mock-login', loginLimiter, async (req, res) => {",false
0P5VIh07pDX76Q,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,181,"router.get('/callback', async (req, res) => {",false
7DKcoK7pQv_ZfA,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,201,"router.post('/demo-admin-login', loginLimiter, async (req, res) => {",false
kXOqiuejKM1NeA,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,8,"router.get(""/"", async (req, res) => {",false
OKLOn7XUXu5OGw,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,19,"router.get(""/:id"", async (req, res) => {",false
BSQjwykLxCsaDA,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,82,"router.post(""/validate"", async (req, res) => {",false
Pai4Tud7628cFw,unauthRoute,Route missing authentication middleware,high,server/routes/cart.ts,9,"router.post(""/sync"", requireSessionOrAuth, rateLimit(20, 60000), async (req, res) => {",false
6IVnWvezkWHP8w,unvalidatedInput,Request data destructured without validation,critical,server/routes/email-test.ts,10,"const { type, email, testData } = req.body;",false
GVlSGPTA7JTqHA,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,14,"router.get(""/orders"", async (req, res) => {",false
2_r6hWPc9JvH4w,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,38,"router.get(""/orders/:id"", async (req, res) => {",false
KAB-BJYyiBMo2A,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,73,"router.post(""/orders/:id/reorder"", async (req, res) => {",false
oa0DlXgruDiW2g,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,262,"router.get(""/addresses"", async (req, res) => {",false
X7Znio5BMGOpoQ,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
EewO7U7MRAEiLw,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,300,"router.put(""/addresses/:id"", async (req, res) => {",false
x5zy9KIp0CLDYQ,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
9sUZVrCu0Y7sJw,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,382,"router.get(""/"", async (req, res) => {",false
GDFiwKShNXpWCg,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
G3NHj_oJ9qEc5A,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
wD9lTH3KSe_6vw,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,8,"router.get(""/my-referral"", async (req, res) => {",false
BsifRMhvLihdhQ,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,26,"router.get(""/stats"", async (req, res) => {",false
eO7s8cPvNvO3GA,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,41,"router.post(""/validate"", async (req, res) => {",false
7wb0fouO_2SpYg,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,70,"router.post(""/claim"", async (req, res) => {",false
lqaEHu-Vs8SvMA,unauthRoute,Route missing authentication middleware,high,server/routes/stripe.ts,9,"router.post(""/webhook"", express.raw({ type: ""application/json"" }), async (req, res) => {",false
NaA8LZrn4Xf7bQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/subscriptions.ts,108,"const { id } = req.params;",false
LExoQrMY95lyHQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/subscriptions.ts,146,"const { id } = req.params;",false
uhIyXtCLS2cGHQ,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,220,"const { id } = req.params;",false
8ZDETDb-kvuH4A,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,231,"const { id } = req.params;",false
B0gdMNkyQv_bMA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,245,"const { id } = req.params;",false
ova_n2c_CNk5iA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,311,"const { orderData, lineItems, successUrl, cancelUrl, sessionToken, discountCode } = req.body;",false
kklZW20m_8Wy4Q,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,446,"const { orderData, returnUrl } = req.body;",false
oIfoDMF8xXC04w,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,485,"const { code, subtotal, cartTotal } = req.body;",false
DTve3B60LBvjRA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,619,"const { items } = req.query;",false
DpLMOhk2Kwk78Q,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,699,"const { status } = req.body;",false
LH-ptEls54c7CQ,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,713,"const { quantity } = req.body;",false
qpWpGfWlLGm11w,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,742,"const { productId, productName, currentStock } = req.body;",false
xTaLN7zlI_jKNQ,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,789,"const { firstName, email, product, restockDate } = req.body;",false