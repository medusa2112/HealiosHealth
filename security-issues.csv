ID,Type,Description,Severity,File,Line,Snippet,Fixed
sX3zW0sN0xGZyA,unvalidatedInput,Request data destructured without validation,critical,server/lib/auth.ts,223,"const { customerEmail } = req.body;",false
GZPOm4xcmiFghA,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/carts.ts,80,"const { cartId } = req.params;",false
mCKCPsfCt2w8Aw,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/logs.ts,72,"const { adminId } = req.params;",false
PUNva_mau6Dlew,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin/logs.ts,84,"const { targetType, targetId } = req.params;",false
A_1cj1AZEHYdzw,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,593,"const { status, channel, limit = 100 } = req.query;",false
ybepGdrfRW7HNw,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,826,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
HCxT-pS6KhiJrA,unvalidatedInput,Request data destructured without validation,critical,server/routes/admin.ts,873,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
bR0FQKyy-F0OZw,rawSQL,Raw SQL query without parameterization,critical,server/routes/admin.ts,698,"const orderCountResult = await db.execute(sql`SELECT COUNT(*) as count FROM orders`);",false
qqo50dKRUxZB_g,rawSQL,Raw SQL query without parameterization,critical,server/routes/admin.ts,702,"sql`SELECT SUM(CAST(total_amount AS DECIMAL)) as total FROM orders WHERE payment_status = 'completed'`",false
NC8-Z7UOqncqxQ,rawSQL,Raw SQL query without parameterization,critical,server/routes/admin.ts,727,"sql`SELECT COUNT(DISTINCT customer_email) as count FROM orders WHERE created_at >= NOW() - INTERVAL '30 days'`",false
QKEcn821ASZrPQ,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,260,"router.post('/products', requireAuth, auditAction('create_product', 'product'), async (req, res) => {",false
lcO2hWL4GM2g5w,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,324,"router.put('/products/:id', requireAuth, auditAction('update_product', 'product'), async (req, res) => {",false
1V8CLeOrwGBqhg,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,402,"router.delete('/products/:id', requireAuth, auditAction('delete_product', 'product'), async (req, res) => {",false
f-_b2a4rgQnXxA,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,824,"router.post('/products/:id/variants', requireAuth, async (req, res) => {",false
vA2S1dv76Ha01g,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,915,"router.delete('/product-variants/:id', requireAuth, async (req, res) => {",false
l9d0_LQtd0_MZg,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,142,"const { id: bundleId } = req.params;",false
0m-nUI88xPAUGg,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,143,"const { items } = req.body; // Array of { variantId, quantity }",false
3OM__RQ27zQPdw,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,233,"const { id } = req.params;",false
h5t3Tk8MQx0HCw,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,273,"const { bundleId, itemId } = req.params;",false
Tg0MxXqWsF2JHw,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminBundles.ts,302,"const { id } = req.params;",false
BzPn6mlkMWNuCw,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,96,"router.post(""/"", requireAuth, async (req, res) => {",false
pn-ChghJ3qrgTw,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,231,"router.put(""/:id"", requireAuth, async (req, res) => {",false
ZAJkMC6e-kGvMg,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,300,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
YF6PEB_6F0RJww,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,21,"router.post(""/"", requireAuth, async (req, res) => {",false
gK662Sq_dm7Blw,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,169,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
3mOdsUMsChhJLA,unvalidatedInput,Request data destructured without validation,critical,server/routes/adminImages.ts,27,"const { uploadURL } = req.body;",false
BtKVAAH22M_pXw,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,35,"router.post(""/chat"", async (req, res) => {",false
h_2RpO0ZLKoFHQ,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,89,"router.post(""/escalate"", async (req, res) => {",false
7M2ZdWnbGTQl3A,unauthRoute,Route missing authentication middleware,high,server/routes/aiAssistant.ts,179,"router.post(""/feedback"", async (req, res) => {",false
rwkjyUPnCLBqWg,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,19,"router.get(""/issues"", async (req, res) => {",false
NcaBThq7F4Sw2A,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,32,"router.get(""/status"", async (req, res) => {",false
9tVHPmOQd9KYNA,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,51,"router.post(""/issues/:id/fix-prompt"", async (req, res) => {",false
InJAXqUjd5Rmlg,unauthRoute,Route missing authentication middleware,high,server/routes/alfr3d.ts,91,"router.post(""/scan"", async (req, res) => {",false
5j9BCbsIoWBF7g,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,53,"const { id } = req.params;",false
eeXCgc_M5xyMoQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,184,"const { id } = req.params;",false
UzzayaTPcsRwtg,unvalidatedInput,Request data destructured without validation,critical,server/routes/alfr3d.ts,185,"const { status } = req.body;",false
iXWm-aUu8dNiNw,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,25,"router.get('/me', async (req, res) => {",false
ZnYcXfhF8DB92w,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,74,"router.post(""/register"", (req, res) => {",false
w1GQsyQg6YIymw,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,79,"router.get('/login', (req, res) => {",false
Opfi9VFKig3bKw,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,90,"router.post('/logout', async (req, res) => {",false
mA8_E9MiqekyVw,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,108,"router.post('/mock-login', loginLimiter, async (req, res) => {",false
2v0C-tWyAUUppQ,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,181,"router.get('/callback', async (req, res) => {",false
ccLbAZBsARUokQ,unauthRoute,Route missing authentication middleware,high,server/routes/auth.ts,201,"router.post('/demo-admin-login', loginLimiter, async (req, res) => {",false
N4EMPh_ysTOOQQ,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,8,"router.get(""/"", async (req, res) => {",false
mlDadrVdDRxVDA,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,19,"router.get(""/:id"", async (req, res) => {",false
fZJnLJ5SPjlBXA,unauthRoute,Route missing authentication middleware,high,server/routes/bundles.ts,82,"router.post(""/validate"", async (req, res) => {",false
V88FWd84rv0E-A,unauthRoute,Route missing authentication middleware,high,server/routes/cart.ts,9,"router.post(""/sync"", requireSessionOrAuth, rateLimit(20, 60000), async (req, res) => {",false
xSYmxhQSQywYeg,unvalidatedInput,Request data destructured without validation,critical,server/routes/email-test.ts,10,"const { type, email, testData } = req.body;",false
AF0tJyAYq7eHyw,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,14,"router.get(""/orders"", async (req, res) => {",false
wlzehMJclZl9wg,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,38,"router.get(""/orders/:id"", async (req, res) => {",false
8fKmMqaVoMAkrA,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,73,"router.post(""/orders/:id/reorder"", async (req, res) => {",false
gaMCeuCDoTzzUw,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,262,"router.get(""/addresses"", async (req, res) => {",false
KRpXc-GtvHF08Q,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
av4gP5rJN2g_eA,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,300,"router.put(""/addresses/:id"", async (req, res) => {",false
v_2E26xPKDXsyQ,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
crzG6dnJBa1yBA,unauthRoute,Route missing authentication middleware,high,server/routes/portal.ts,382,"router.get(""/"", async (req, res) => {",false
KuUSt8OzQq1QQg,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
PstTUKU3qNsWrw,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
324z34rhZpmqPg,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,8,"router.get(""/my-referral"", async (req, res) => {",false
sddLSXCf9VBZ3A,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,26,"router.get(""/stats"", async (req, res) => {",false
LtPou7DhbMxi6Q,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,41,"router.post(""/validate"", async (req, res) => {",false
iYM6yXro8glVCA,unauthRoute,Route missing authentication middleware,high,server/routes/referrals.ts,70,"router.post(""/claim"", async (req, res) => {",false
ZbC4cEfcNKjGXQ,unauthRoute,Route missing authentication middleware,high,server/routes/stripe.ts,9,"router.post(""/webhook"", express.raw({ type: ""application/json"" }), async (req, res) => {",false
OzcdXISJ2DLYeQ,unvalidatedInput,Request data destructured without validation,critical,server/routes/subscriptions.ts,108,"const { id } = req.params;",false
zsV1epjw1WwY9g,unvalidatedInput,Request data destructured without validation,critical,server/routes/subscriptions.ts,146,"const { id } = req.params;",false
tnsQo9jqVNVuKg,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,220,"const { id } = req.params;",false
8oc9B6YOfVIX2Q,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,231,"const { id } = req.params;",false
zbb3ZmwTYMm7QA,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,245,"const { id } = req.params;",false
eXJ0JoAIQhkd2w,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,311,"const { orderData, lineItems, successUrl, cancelUrl, sessionToken, discountCode } = req.body;",false
AM7pMg-MkA9o7g,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,446,"const { orderData, returnUrl } = req.body;",false
or8id3aiWYTKpg,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,485,"const { code, subtotal, cartTotal } = req.body;",false
AWKe5gtfwmU0Aw,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,619,"const { items } = req.query;",false
bvo1kxJPwzFvMQ,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,699,"const { status } = req.body;",false
Hn9LYwnvOhcM1g,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,713,"const { quantity } = req.body;",false
2_t_5jA_sUd7cw,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,742,"const { productId, productName, currentStock } = req.body;",false
bor9mlZVh38c_g,unvalidatedInput,Request data destructured without validation,critical,server/routes.ts,789,"const { firstName, email, product, restockDate } = req.body;",false