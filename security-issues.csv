ID,Type,Description,Severity,File,Line,Snippet,Fixed
NH8kd1rpy9oiag,unvalidatedInput,Request data used without validation,critical,server/lib/auditMiddleware.ts,20,"const targetId = req.params.id || req.params.orderId || req.params.productId || req.body.id || 'unknown';",false
ZINyqmY6rKC9UQ,unvalidatedInput,Request data used without validation,critical,server/lib/auditMiddleware.ts,34,"query: req.query,",false
lMcmKj7QQElHUA,unvalidatedInput,Request data used without validation,critical,server/lib/auditMiddleware.ts,35,"body: sanitizeBody(req.body),",false
0u0nBMtSXDE2cw,unvalidatedInput,Request data used without validation,critical,server/lib/auditMiddleware.ts,55,"query: req.query,",false
uerIhTCeHcevqA,unvalidatedInput,Request data used without validation,critical,server/lib/auditMiddleware.ts,56,"body: sanitizeBody(req.body),",false
WESanCfANSwqWA,unvalidatedInput,Request data used without validation,critical,server/lib/auth.ts,186,"const sessionToken = req.body.sessionToken || req.headers['x-session-token'];",false
RPwTB_NFFB8IBQ,unvalidatedInput,Request data used without validation,critical,server/lib/auth.ts,202,"const { customerEmail } = req.body;",false
-EMqY7WX9Pgw4g,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/abandoned-carts.ts,9,"router.get('/abandoned-carts', requireAuth, async (req, res) => {",false
qbPtdUsiUuWMnw,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/abandoned-carts.ts,69,"router.post('/send-recovery-email', requireAuth, async (req, res) => {",false
Sm7xcRgdxO9sXQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/abandoned-carts.ts,128,"router.get('/cart-analytics', requireAuth, async (req, res) => {",false
8KDLJ5NCRy6zGw,unvalidatedInput,Request data used without validation,critical,server/routes/admin/abandoned-carts.ts,15,"const result = querySchema.safeParse(req.query);",false
wn12AO3_qEZmhg,unvalidatedInput,Request data used without validation,critical,server/routes/admin/abandoned-carts.ts,78,"const result = bodySchema.safeParse(req.body);",false
twKgOKB6kuSNnw,unvalidatedInput,Request data used without validation,critical,server/routes/admin/abandoned-carts.ts,134,"const result = querySchema.safeParse(req.query);",false
zt5wj_BLKWP_Dg,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/carts.ts,10,"router.get(""/"", requireAuth, async (req, res) => {",false
7QHExKQ5fEar1g,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/carts.ts,49,"router.get(""/analytics"", requireAuth, async (req, res) => {",false
9UE9-BiR7D_31w,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/carts.ts,78,"router.post(""/:cartId/recover"", requireAuth, async (req, res) => {",false
D7oVLSxJauszMw,unvalidatedInput,Request data used without validation,critical,server/routes/admin/carts.ts,12,"const hoursAgo = parseInt(req.query.hours as string) || 1;",false
tcQujXAhyV3fXA,unvalidatedInput,Request data used without validation,critical,server/routes/admin/carts.ts,80,"const { cartId } = req.params;",false
LKkoJnwzDGgeBA,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/logs.ts,10,"router.get(""/"", requireAuth, async (req, res) => {",false
EqpDNIIP4JEARA,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/logs.ts,35,"router.get(""/admin/:adminId"", requireAuth, async (req, res) => {",false
mDjoEHg_EksBqw,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/logs.ts,47,"router.get(""/target/:targetType/:targetId"", requireAuth, async (req, res) => {",false
1-IaPS_RdxV-qw,unvalidatedInput,Request data used without validation,critical,server/routes/admin/logs.ts,12,"const limit = parseInt(req.query.limit as string) || 100;",false
3kw6U2t9Yn_gmw,unvalidatedInput,Request data used without validation,critical,server/routes/admin/logs.ts,13,"const adminId = req.query.adminId as string;",false
pghV47rmTEmadQ,unvalidatedInput,Request data used without validation,critical,server/routes/admin/logs.ts,14,"const targetType = req.query.targetType as string;",false
gvr7YpO9-8wVCA,unvalidatedInput,Request data used without validation,critical,server/routes/admin/logs.ts,15,"const targetId = req.query.targetId as string;",false
VWWcN53OjqX02Q,unvalidatedInput,Request data used without validation,critical,server/routes/admin/logs.ts,37,"const { adminId } = req.params;",false
ijen9EztJc4uNA,unvalidatedInput,Request data used without validation,critical,server/routes/admin/logs.ts,49,"const { targetType, targetId } = req.params;",false
FEdQLjlCNI0MpQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/orders.ts,11,"router.get(""/"", requireAuth, async (req, res) => {",false
UmWh4YrJG8Kj8A,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/orders.ts,28,"router.get(""/:id"", requireAuth, async (req, res) => {",false
Bz8ykS0wLUKeyw,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/orders.ts,63,"router.post(""/:id/refund"", requireAuth, async (req, res) => {",false
yVjXJZKuOl12xQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/orders.ts,172,"router.put(""/:id/status"", requireAuth, async (req, res) => {",false
zoXxLzluVQk08A,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin/orders.ts,220,"router.get(""/stats/summary"", requireAuth, async (req, res) => {",false
flpqywwwBCdGzQ,unvalidatedInput,Request data used without validation,critical,server/routes/admin/orders.ts,34,"const result = paramsSchema.safeParse(req.params);",false
UrrqYMQemMwFZg,unvalidatedInput,Request data used without validation,critical,server/routes/admin/orders.ts,69,"const paramsResult = paramsSchema.safeParse(req.params);",false
1ibw7UcNU95kVw,unvalidatedInput,Request data used without validation,critical,server/routes/admin/orders.ts,82,"const bodyResult = bodySchema.safeParse(req.body);",false
4kmDTqClbCmfXQ,unvalidatedInput,Request data used without validation,critical,server/routes/admin/orders.ts,178,"const paramsResult = paramsSchema.safeParse(req.params);",false
QDV-qvNVKyS_pA,unvalidatedInput,Request data used without validation,critical,server/routes/admin/orders.ts,190,"const bodyResult = bodySchema.safeParse(req.body);",false
OLKldjokHCRUXw,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,28,"router.get('/logs', requireAuth, async (req, res) => {",false
UISyNChxJM3VUw,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,52,"router.get('/', requireAuth, async (req, res) => {",false
E5FHsSPHD_gLZQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,93,"router.get('/products', requireAuth, async (req, res) => {",false
8NWWvw46CyTgZQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,126,"router.get('/products/:id', requireAuth, async (req, res) => {",false
S1A5zpJGhVOnSQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,151,"router.post('/products', requireAuth, auditAction('create_product', 'product'), async (req, res) => {",false
4jalEUBQoaX_ng,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,215,"router.put('/products/:id', requireAuth, auditAction('update_product', 'product'), async (req, res) => {",false
MBjeEufClxsOcA,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,291,"router.delete('/products/:id', requireAuth, auditAction('delete_product', 'product'), async (req, res) => {",false
jkBrHBLfpA2Fsw,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,325,"router.put('/products/:id/stock', requireAuth, auditAction('update_stock', 'product'), async (req, res) => {",false
gIjkjWyemOB00g,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,375,"router.get('/orders', requireAuth, async (req, res) => {",false
UsML9kemeg6oJQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,385,"router.get('/quiz/analytics', requireAuth, async (req, res) => {",false
LkZ2Zug6z3eUCg,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,420,"router.get(""/reorder-logs"", requireAuth, async (req, res) => {",false
8WpzWIodw0jq7g,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,436,"router.get(""/reorder-analytics"", requireAuth, async (req, res) => {",false
SA1-Y2B0id2LNQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,515,"router.get('/products/:id/variants', requireAuth, async (req, res) => {",false
TMxn8hYMbKgvRw,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,525,"router.post('/products/:id/variants', requireAuth, async (req, res) => {",false
sjf-caotKfbTTA,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,572,"router.put('/product-variants/:id', requireAuth, async (req, res) => {",false
RsDQ4BAmKWEZCA,unauthRoute,Route missing requireAuth middleware,high,server/routes/admin.ts,616,"router.delete('/product-variants/:id', requireAuth, async (req, res) => {",false
1Lm8Kp6EXcaZJw,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,34,"const result = querySchema.safeParse(req.query);",false
rxwy-GJ3JAhJYQ,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,132,"const result = paramsSchema.safeParse(req.params);",false
Wv_1HyRQ2vw7LQ,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,168,"const result = productSchema.safeParse(req.body);",false
kGbpD6RqzHNQzw,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,221,"const paramsResult = paramsSchema.safeParse(req.params);",false
Hgt5_tqCtSwNvQ,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,245,"const bodyResult = updateSchema.safeParse(req.body);",false
dqlLjzkM42t0hg,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,297,"const result = paramsSchema.safeParse(req.params);",false
AQPiZ5IwMN6vOg,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,331,"const paramsResult = paramsSchema.safeParse(req.params);",false
W3uTFQ5Crl7Vxw,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,343,"const bodyResult = bodySchema.safeParse(req.body);",false
g1POdYzLFFc-Zg,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,363,"req.params.id,",false
0zl4YKK8XSkQ6A,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,422,"const { status, channel, limit = 100 } = req.query;",false
86bwy-PHGV9iHw,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,517,"const variants = await storage.getProductVariants(req.params.id);",false
IzAaTAx9gBAM4A,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,527,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
3bgSVB_zH4zeiQ,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,528,"const productId = req.params.id;",false
t79ywoeCSIc6Bw,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,574,"const { name, sku, type, attributes, price, imageUrl, stockQuantity, inStock, isDefault } = req.body;",false
Ik0M-c6RXJoZmw,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,575,"const variantId = req.params.id;",false
Zr4v94KCk0zV2w,unvalidatedInput,Request data used without validation,critical,server/routes/admin.ts,618,"const variantId = req.params.id;",false
OXb3mfef_FKK2Q,rawSQL,Raw SQL query detected (injection risk),critical,server/routes/admin.ts,61,"const quizCount = await db.execute(sql`SELECT COUNT(*) as count FROM quiz_results`);",false
pL6u07tsPqS_RA,rawSQL,Raw SQL query detected (injection risk),critical,server/routes/admin.ts,392,"const quizResultsQuery = await db.execute(sql`SELECT * FROM quiz_results ORDER BY created_at DESC LIMIT 20`);",false
O4uw8ZFzQXgRtA,rawSQL,Raw SQL query detected (injection risk),critical,server/routes/admin.ts,395,"const countQuery = await db.execute(sql`SELECT COUNT(*) as count FROM quiz_results`);",false
KyFPUPvL4vtxzw,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,151,"router.post('/products', requireAuth, auditAction('create_product', 'product'), async (req, res) => {",false
QUVuszyzCpKJ3A,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,215,"router.put('/products/:id', requireAuth, auditAction('update_product', 'product'), async (req, res) => {",false
_1_59YGu5nW9mA,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,291,"router.delete('/products/:id', requireAuth, auditAction('delete_product', 'product'), async (req, res) => {",false
kCNz9_VpeYq2sQ,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,525,"router.post('/products/:id/variants', requireAuth, async (req, res) => {",false
Nu3OXzA6trCsKA,duplicateRoute,Duplicate route definition,medium,server/routes/admin.ts,616,"router.delete('/product-variants/:id', requireAuth, async (req, res) => {",false
nxR3DJIdY0Z4iA,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,10,"router.get(""/"", requireAuth, async (req, res) => {",false
FEbB4oNHYggsKQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,21,"router.get(""/:id"", requireAuth, async (req, res) => {",false
2-JurSBiGHO-sw,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,50,"router.get(""/variants/eligible"", requireAuth, async (req, res) => {",false
T7jon-BGNm1_CQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,96,"router.post(""/"", requireAuth, async (req, res) => {",false
h25GA3j9LbQzVA,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,140,"router.post(""/:id/items"", requireAuth, async (req, res) => {",false
m5VA3cd4aZGh1w,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,231,"router.put(""/:id"", requireAuth, async (req, res) => {",false
6wGPaa3m1ZHUmg,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,271,"router.delete(""/:bundleId/items/:itemId"", requireAuth, async (req, res) => {",false
zGzudtU6YD0Sew,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminBundles.ts,300,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
-4wFQt1d3hHVqA,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,27,"const result = paramsSchema.safeParse(req.params);",false
eKviLdP46tZkCg,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,56,"const result = querySchema.safeParse(req.query);",false
sionWGv7GaEpzg,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,98,"const validationResult = insertProductBundleSchema.safeParse(req.body);",false
DycW-Swwggr9lA,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,142,"const { id: bundleId } = req.params;",false
t9IsAHBEi912BA,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,143,"const { items } = req.body; // Array of { variantId, quantity }",false
Xqr6S4mXc6Eg4g,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,233,"const { id } = req.params;",false
4PCRc5hFh4Z8TQ,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,236,"const validationResult = updateSchema.safeParse(req.body);",false
H9Kb3kWmiBNfyw,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,273,"const { bundleId, itemId } = req.params;",false
JLPfZ1o4lyOMdQ,unvalidatedInput,Request data used without validation,critical,server/routes/adminBundles.ts,302,"const { id } = req.params;",false
GFdxRutLLzVr7w,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,96,"router.post(""/"", requireAuth, async (req, res) => {",false
XC78nmrIjohcvA,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,231,"router.put(""/:id"", requireAuth, async (req, res) => {",false
FVK_ZFOIZcfwDg,duplicateRoute,Duplicate route definition,medium,server/routes/adminBundles.ts,300,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
j_tSzRg970b9-g,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminDiscounts.ts,10,"router.get(""/"", requireAuth, async (req, res) => {",false
9TW2D-s8yRlzNg,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminDiscounts.ts,21,"router.post(""/"", requireAuth, async (req, res) => {",false
PpvXVVidd_wEDw,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminDiscounts.ts,87,"router.put(""/:id"", requireAuth, async (req, res) => {",false
D2uVW6eVepujow,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminDiscounts.ts,169,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
7Z_S-XfWavk28g,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminDiscounts.ts,221,"router.post(""/validate"", requireAuth, async (req, res) => {",false
HM0zIu51mAYOFg,unvalidatedInput,Request data used without validation,critical,server/routes/adminDiscounts.ts,23,"const validationResult = insertDiscountCodeSchema.safeParse(req.body);",false
wksmHGg8J3Sv4A,unvalidatedInput,Request data used without validation,critical,server/routes/adminDiscounts.ts,93,"const paramsResult = paramsSchema.safeParse(req.params);",false
bP0SYqG0tuZ1yQ,unvalidatedInput,Request data used without validation,critical,server/routes/adminDiscounts.ts,104,"const validationResult = updateSchema.safeParse(req.body);",false
blC9WieNuNJu9g,unvalidatedInput,Request data used without validation,critical,server/routes/adminDiscounts.ts,175,"const result = paramsSchema.safeParse(req.params);",false
-44ISxuYSvF68Q,unvalidatedInput,Request data used without validation,critical,server/routes/adminDiscounts.ts,227,"const result = validateSchema.safeParse(req.body);",false
crg1VeaW479hbA,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,21,"router.post(""/"", requireAuth, async (req, res) => {",false
odqLTKkWS8FEOg,duplicateRoute,Duplicate route definition,medium,server/routes/adminDiscounts.ts,169,"router.delete(""/:id"", requireAuth, async (req, res) => {",false
gEavGzgEq2ZayQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminImages.ts,11,"router.post(""/upload-url"", requireAuth, async (req, res) => {",false
zPXbShZ4NecpvQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/adminImages.ts,25,"router.post(""/confirm"", requireAuth, async (req, res) => {",false
ZCopEgXUYHSN9w,unvalidatedInput,Request data used without validation,critical,server/routes/adminImages.ts,27,"const { uploadURL } = req.body;",false
w8CLdfAOm7dsbA,unauthRoute,Route missing requireAuth middleware,high,server/routes/aiAssistant.ts,35,"router.post(""/chat"", async (req, res) => {",false
KREdTOXVcXP3iA,unauthRoute,Route missing requireAuth middleware,high,server/routes/aiAssistant.ts,89,"router.post(""/escalate"", async (req, res) => {",false
7fxIZfPmzvu2_g,unauthRoute,Route missing requireAuth middleware,high,server/routes/aiAssistant.ts,122,"router.get(""/session/:id"", requireAuth, async (req, res) => {",false
8yWqZHw4NBSCVA,unauthRoute,Route missing requireAuth middleware,high,server/routes/aiAssistant.ts,159,"router.get(""/sessions"", requireAuth, async (req, res) => {",false
W2gASUvGIm2JCw,unauthRoute,Route missing requireAuth middleware,high,server/routes/aiAssistant.ts,179,"router.post(""/feedback"", async (req, res) => {",false
rpJUIhgeSOGSrg,unvalidatedInput,Request data used without validation,critical,server/routes/aiAssistant.ts,42,"const result = chatSchema.safeParse(req.body);",false
zfxo9PHNEz0t5w,unvalidatedInput,Request data used without validation,critical,server/routes/aiAssistant.ts,96,"const result = escalateSchema.safeParse(req.body);",false
hTQLQePwNN9JeA,unvalidatedInput,Request data used without validation,critical,server/routes/aiAssistant.ts,128,"const paramsResult = paramsSchema.safeParse(req.params);",false
uRCkn8AkNPBX4w,unvalidatedInput,Request data used without validation,critical,server/routes/aiAssistant.ts,187,"const result = feedbackSchema.safeParse(req.body);",false
NIldlLWsDNFk4Q,unauthRoute,Route missing requireAuth middleware,high,server/routes/alfr3d.ts,16,"router.get(""/issues"", async (req, res) => {",false
uuxjuAv-BNtgFA,unauthRoute,Route missing requireAuth middleware,high,server/routes/alfr3d.ts,29,"router.get(""/status"", async (req, res) => {",false
bjWsW-vQWFdkEg,unauthRoute,Route missing requireAuth middleware,high,server/routes/alfr3d.ts,48,"router.post(""/issues/:id/fix-prompt"", async (req, res) => {",false
FsNl185QZuhJRw,unauthRoute,Route missing requireAuth middleware,high,server/routes/alfr3d.ts,88,"router.post(""/scan"", async (req, res) => {",false
b0YnaqRYVI1QRQ,unvalidatedInput,Request data used without validation,critical,server/routes/alfr3d.ts,50,"const { id } = req.params;",false
QOx0G2TBYVgbcA,unvalidatedInput,Request data used without validation,critical,server/routes/alfr3d.ts,108,"const { id } = req.params;",false
DCyZm0Fknqt6zg,unvalidatedInput,Request data used without validation,critical,server/routes/alfr3d.ts,109,"const { status } = req.body;",false
4RDAqQqTvvjQtQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,12,"router.get('/me', async (req, res) => {",false
vUG1pZzUcAhasw,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,41,"router.get('/user', isAuthenticated, async (req, res) => {",false
I_ydULQOMEKiWA,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,61,"router.post(""/register"", (req, res) => {",false
DLVk6WeAGgVakA,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,66,"router.get('/login', (req, res) => {",false
G59v0IH_OM34rA,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,77,"router.post('/logout', async (req, res) => {",false
7JB1hpsRVQQSyg,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,95,"router.post('/mock-login', async (req, res) => {",false
cfiwem6JwaO3fw,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,168,"router.get('/callback', async (req, res) => {",false
Takz1rUYr5HHhw,unauthRoute,Route missing requireAuth middleware,high,server/routes/auth.ts,188,"router.post('/demo-admin-login', async (req, res) => {",false
vIbkqN_Cg0jFvQ,unvalidatedInput,Request data used without validation,critical,server/routes/auth.ts,103,"const result = mockLoginSchema.safeParse(req.body);",false
1udsOaZXTTShjw,unvalidatedInput,Request data used without validation,critical,server/routes/auth.ts,155,"const emailResult = z.object({ email: z.string().optional() }).safeParse(req.body);",false
8vGUl3w9DXOkig,unauthRoute,Route missing requireAuth middleware,high,server/routes/bundles.ts,8,"router.get(""/"", async (req, res) => {",false
5hGd5ewjdvQ5SQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/bundles.ts,19,"router.get(""/:id"", async (req, res) => {",false
qDZ3NzgO3F8h9g,unauthRoute,Route missing requireAuth middleware,high,server/routes/bundles.ts,82,"router.post(""/validate"", async (req, res) => {",false
iK4rXWt4_fc-kg,unvalidatedInput,Request data used without validation,critical,server/routes/bundles.ts,25,"const result = paramsSchema.safeParse(req.params);",false
zXpJE_BCeVjqRQ,unvalidatedInput,Request data used without validation,critical,server/routes/bundles.ts,92,"const result = validateSchema.safeParse(req.body);",false
_O-xYZWYuKJxEQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/cart.ts,9,"router.post(""/sync"", requireSessionOrAuth, rateLimit(20, 60000), async (req, res) => {",false
AhI0n_jF72zcRg,unauthRoute,Route missing requireAuth middleware,high,server/routes/cart.ts,51,"router.get(""/:sessionToken"", requireAuth, async (req, res) => {",false
e5D51tz1R9gT7w,unauthRoute,Route missing requireAuth middleware,high,server/routes/cart.ts,89,"router.put(""/:cartId/abandon"", requireAuth, async (req, res) => {",false
ZsU0sz1G7ZHYww,unvalidatedInput,Request data used without validation,critical,server/routes/cart.ts,18,"const result = syncSchema.safeParse(req.body);",false
hQpNRGuZFLcOAQ,unvalidatedInput,Request data used without validation,critical,server/routes/cart.ts,57,"const result = paramsSchema.safeParse(req.params);",false
RvIcC2g7DTEZeA,unvalidatedInput,Request data used without validation,critical,server/routes/cart.ts,95,"const result = paramsSchema.safeParse(req.params);",false
L9e2cTGEcmmpgg,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-jobs.ts,12,"router.post(""/abandoned-carts"", requireAuth, async (req, res) => {",false
DDTX96UCWfl_Fg,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-jobs.ts,30,"router.post(""/reorder-reminders"", requireAuth, async (req, res) => {",false
dkMEmS00l_ChFg,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-jobs.ts,48,"router.post(""/all"", requireAuth, async (req, res) => {",false
lluKG7qZ9BvP2g,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-jobs.ts,66,"router.get(""/stats"", requireAuth, async (req, res) => {",false
zDPvYSoAgEhwMw,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-jobs.ts,104,"router.post(""/scheduler/start"", requireAuth, async (req, res) => {",false
i0eaQcvqwPGkNQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-jobs.ts,120,"router.post(""/scheduler/stop"", requireAuth, async (req, res) => {",false
4UVwgKJbXEGOxw,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-test.ts,8,"router.post(""/test"", requireAuth, async (req, res) => {",false
ebfQPfqcjHRiUw,unauthRoute,Route missing requireAuth middleware,high,server/routes/email-test.ts,80,"router.get(""/status"", requireAuth, (req, res) => {",false
ZWbB8NVdwmMURA,unvalidatedInput,Request data used without validation,critical,server/routes/email-test.ts,10,"const { type, email, testData } = req.body;",false
wRaHBuWVkbyVxQ,unvalidatedInput,Request data used without validation,critical,server/routes/objectStorage.ts,19,"const result = paramsSchema.safeParse(req.params);",false
4JlDO0WNJYC_uQ,unvalidatedInput,Request data used without validation,critical,server/routes/objectStorage.ts,72,"const result = bodySchema.safeParse(req.body);",false
SGMBrZYdK8zlJg,unvalidatedInput,Request data used without validation,critical,server/routes/objectStorage.ts,83,"req.body.imageURL,",false
QJeJ_eYVLHT50A,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,14,"router.get(""/orders"", async (req, res) => {",false
I1AsiWOcxOs6Mw,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,38,"router.get(""/orders/:id"", async (req, res) => {",false
_hK2lyCsdHmVLg,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,73,"router.post(""/orders/:id/reorder"", async (req, res) => {",false
pfZD7GSWaPw2CA,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,262,"router.get(""/addresses"", async (req, res) => {",false
8IgC8pvo2APvNg,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
g6V9GrxTy73JEg,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,300,"router.put(""/addresses/:id"", async (req, res) => {",false
pjGIPDh7AMd6bQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
Z-gc5VDHW-0PAQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/portal.ts,382,"router.get(""/"", async (req, res) => {",false
TQ0gP4GZPczktw,unvalidatedInput,Request data used without validation,critical,server/routes/portal.ts,44,"const result = paramsSchema.safeParse(req.params);",false
TNwdOC48Rlro-Q,unvalidatedInput,Request data used without validation,critical,server/routes/portal.ts,82,"const paramsResult = paramsSchema.safeParse(req.params);",false
gMDN9oGJLk0v5g,unvalidatedInput,Request data used without validation,critical,server/routes/portal.ts,83,"const bodyResult = bodySchema.safeParse(req.body);",false
0pOkXUz0QsMhVA,unvalidatedInput,Request data used without validation,critical,server/routes/portal.ts,278,"...req.body,",false
Dh82v2C-Lwv01A,unvalidatedInput,Request data used without validation,critical,server/routes/portal.ts,306,"const paramsResult = paramsSchema.safeParse(req.params);",false
H3finrFiEwXirA,unvalidatedInput,Request data used without validation,critical,server/routes/portal.ts,326,"const bodyResult = updateSchema.safeParse(req.body);",false
gVE0wLZwAZ-ukQ,unvalidatedInput,Request data used without validation,critical,server/routes/portal.ts,354,"const result = paramsSchema.safeParse(req.params);",false
5U1HTsPoS46S9A,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,274,"router.post(""/addresses"", async (req, res) => {",false
9IIRMZbuDU51Tw,duplicateRoute,Duplicate route definition,medium,server/routes/portal.ts,348,"router.delete(""/addresses/:id"", async (req, res) => {",false
T86dVqH1W17NJg,unauthRoute,Route missing requireAuth middleware,high,server/routes/referrals.ts,8,"router.get(""/my-referral"", async (req, res) => {",false
d81isjwaPGF6RA,unauthRoute,Route missing requireAuth middleware,high,server/routes/referrals.ts,26,"router.get(""/stats"", async (req, res) => {",false
rjCGpU8Ap-tWKQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/referrals.ts,41,"router.post(""/validate"", async (req, res) => {",false
roYdDld99erQtw,unauthRoute,Route missing requireAuth middleware,high,server/routes/referrals.ts,70,"router.post(""/claim"", async (req, res) => {",false
8mOQM0p5DkTZxg,unvalidatedInput,Request data used without validation,critical,server/routes/referrals.ts,48,"const { code, userId } = schema.parse(req.body);",false
mKliRPoEQKovtQ,unvalidatedInput,Request data used without validation,critical,server/routes/referrals.ts,79,"const { referralId, refereeId, orderId, orderAmount } = schema.parse(req.body);",false
jGbuRN2lK0473g,unauthRoute,Route missing requireAuth middleware,high,server/routes/security-audit.ts,10,"router.get('/audit', requireAuth, async (req, res) => {",false
tlJ5kv5LExtHvA,unauthRoute,Route missing requireAuth middleware,high,server/routes/stripe.ts,9,"router.post(""/webhook"", express.raw({ type: ""application/json"" }), async (req, res) => {",false
gR_3VdH_3X6dWw,unvalidatedInput,Request data used without validation,critical,server/routes/stripe.ts,20,"req.body,",false
vqvFtrJPukqyiQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/subscriptions.ts,16,"router.post(""/checkout"", protectRoute([""customer"", ""admin""]), async (req, res) => {",false
m5lIPApKcmkK1A,unauthRoute,Route missing requireAuth middleware,high,server/routes/subscriptions.ts,89,"router.get(""/"", protectRoute([""customer"", ""admin""]), async (req, res) => {",false
toLQA_W69RLmEg,unauthRoute,Route missing requireAuth middleware,high,server/routes/subscriptions.ts,106,"router.post(""/:id/cancel"", protectRoute([""customer"", ""admin""]), async (req, res) => {",false
PlU6SfpFanESFQ,unauthRoute,Route missing requireAuth middleware,high,server/routes/subscriptions.ts,144,"router.post(""/:id/reactivate"", protectRoute([""customer"", ""admin""]), async (req, res) => {",false
rH6w4Z__cN6-SA,unauthRoute,Route missing requireAuth middleware,high,server/routes/subscriptions.ts,182,"router.get(""/admin"", protectRoute([""admin""]), async (req, res) => {",false
RI71eJYTF52yrA,unvalidatedInput,Request data used without validation,critical,server/routes/subscriptions.ts,23,"const validation = createSubscriptionSchema.safeParse(req.body);",false
2YxThtz-RMcJBg,unvalidatedInput,Request data used without validation,critical,server/routes/subscriptions.ts,108,"const { id } = req.params;",false
Ejhy6mDJA1bY1A,unvalidatedInput,Request data used without validation,critical,server/routes/subscriptions.ts,146,"const { id } = req.params;",false
YLZUge-C47kEZg,unvalidatedInput,Request data used without validation,critical,server/routes.ts,124,"const [product] = await db.select().from(products).where(eq(products.id, req.params.id));",false
h-EFEuMB3gupRg,unvalidatedInput,Request data used without validation,critical,server/routes.ts,139,"const category = req.params.category;",false
ugRxhaE22v-L7g,unvalidatedInput,Request data used without validation,critical,server/routes.ts,150,"const validatedData = insertConsultationBookingSchema.parse(req.body);",false
nCkh6kvf3ChunA,unvalidatedInput,Request data used without validation,critical,server/routes.ts,198,"const { id } = req.params;",false
m5x4wJuY4gHXKg,unvalidatedInput,Request data used without validation,critical,server/routes.ts,209,"const { id } = req.params;",false
HqFohsRbudIeJg,unvalidatedInput,Request data used without validation,critical,server/routes.ts,223,"const { id } = req.params;",false
7gCVmNWT0sku_g,unvalidatedInput,Request data used without validation,critical,server/routes.ts,238,"const validatedData = insertNewsletterSchema.parse(req.body);",false
myV1qQRiKoQlMA,unvalidatedInput,Request data used without validation,critical,server/routes.ts,261,"const validatedData = insertRestockNotificationSchema.parse(req.body);",false
HuDy3tX2dDK6gg,unvalidatedInput,Request data used without validation,critical,server/routes.ts,289,"const { orderData, lineItems, successUrl, cancelUrl, sessionToken, discountCode } = req.body;",false
m9IFvJgOAJ0-hQ,unvalidatedInput,Request data used without validation,critical,server/routes.ts,424,"const { orderData, returnUrl } = req.body;",false
lbyOED6NrGKumQ,unvalidatedInput,Request data used without validation,critical,server/routes.ts,463,"const { code, subtotal, cartTotal } = req.body;",false
xexMbER9AkFeZw,unvalidatedInput,Request data used without validation,critical,server/routes.ts,516,"const validatedData = insertOrderSchema.parse(req.body);",false
1meYNvRq3qsTqw,unvalidatedInput,Request data used without validation,critical,server/routes.ts,569,"const order = await storage.getOrderById(req.params.id);",false
CLVB9e6NGl1MKA,unvalidatedInput,Request data used without validation,critical,server/routes.ts,583,"if (req.user?.role !== 'admin' && req.user?.email !== req.params.email) {",false
Bhq-IjI01IxvKg,unvalidatedInput,Request data used without validation,critical,server/routes.ts,587,"const orders = await storage.getOrdersByEmail(req.params.email);",false
FWEzYIVu0izcRw,unvalidatedInput,Request data used without validation,critical,server/routes.ts,597,"const { items } = req.query;",false
cSJ7jP56xICxsA,unvalidatedInput,Request data used without validation,critical,server/routes.ts,677,"const { status } = req.body;",false
VG3phWTetqa_Tw,unvalidatedInput,Request data used without validation,critical,server/routes.ts,678,"const order = await storage.updateOrderStatus(req.params.id, status);",false
38rlbNg3MeHnlQ,unvalidatedInput,Request data used without validation,critical,server/routes.ts,691,"const { quantity } = req.body;",false
ztdqwt9vq-Vzug,unvalidatedInput,Request data used without validation,critical,server/routes.ts,696,"const product = await storage.updateProductStock(req.params.id, quantity);",false
RoX1w9ByGS5kyQ,unvalidatedInput,Request data used without validation,critical,server/routes.ts,720,"const { productId, productName, currentStock } = req.body;",false
MFqj8Dr4kiUBiA,unvalidatedInput,Request data used without validation,critical,server/routes.ts,742,"const validatedData = insertPreOrderSchema.parse(req.body);",false
NMCoGpPn2lFY8Q,unvalidatedInput,Request data used without validation,critical,server/routes.ts,767,"const { firstName, email, product, restockDate } = req.body;",false
12mpH0MOsdigUQ,unvalidatedInput,Request data used without validation,critical,server/routes.ts,807,"const article = await storage.getArticleBySlug(req.params.slug);",false
37WO5VVPeyUp0g,unvalidatedInput,Request data used without validation,critical,server/routes.ts,820,"const articles = await storage.getArticlesByCategory(req.params.category);",false
GqTC7e_ngt_TFQ,unvalidatedInput,Request data used without validation,critical,server/routes.ts,838,"} = req.body;",false
V0MBJfZCDgR2Fg,unvalidatedInput,Request data used without validation,critical,server/security-scanner.ts,209,"console.log('   - Unvalidated request inputs (req.body, req.params, req.query)');",false